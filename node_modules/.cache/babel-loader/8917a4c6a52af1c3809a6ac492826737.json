{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar LocalTrackPublicationSignaling = require('../localtrackpublication');\n\nvar TwilioWarning = require('../../util/twiliowarning');\n\nvar createTwilioError = require('../../util/twilio-video-errors').createTwilioError;\n/**\n * @extends LocalTrackPublicationSignaling\n */\n\n\nvar LocalTrackPublicationV2 =\n/** @class */\nfunction (_super) {\n  __extends(LocalTrackPublicationV2, _super);\n  /**\n   * Construct a {@link LocalTrackPublicationV2}.\n   * @param {DataTrackSender|MediaTrackSender} trackSender\n   * @param {string} name\n   * @param {Track.Priority} priority\n   * @param {object} [options]\n   */\n\n\n  function LocalTrackPublicationV2(trackSender, name, priority, options) {\n    var _this = _super.call(this, trackSender, name, priority) || this;\n\n    Object.defineProperties(_this, {\n      _log: {\n        value: options.log.createLog('default', _this)\n      },\n      _mediaStates: {\n        value: {\n          recordings: null\n        },\n        writable: true\n      }\n    });\n    return _this;\n  }\n  /**\n   * Get the {@link LocalTrackPublicationV2#Representation} of a given {@link TrackSignaling}.\n   * @returns {LocalTrackPublicationV2#Representation} - without the SID\n   */\n\n\n  LocalTrackPublicationV2.prototype.getState = function () {\n    return {\n      enabled: this.isEnabled,\n      id: this.id,\n      kind: this.kind,\n      name: this.name,\n      priority: this.updatedPriority\n    };\n  };\n\n  LocalTrackPublicationV2.prototype.toString = function () {\n    return \"[LocalTrackPublicationV2: \" + this.sid + \"]\";\n  };\n  /**\n   * Compare the {@link LocalTrackPublicationV2} to a {@link LocalTrackPublicationV2#Representation} of itself\n   * and perform any updates necessary.\n   * @param {PublishedTrack} track\n   * @returns {this}\n   * @fires TrackSignaling#updated\n   */\n\n\n  LocalTrackPublicationV2.prototype.update = function (track) {\n    switch (track.state) {\n      case 'ready':\n        this.setSid(track.sid);\n        break;\n\n      case 'failed':\n        {\n          var error = track.error;\n          this.publishFailed(createTwilioError(error.code, error.message));\n          break;\n        }\n\n      default:\n        // 'created'\n        break;\n    }\n\n    return this;\n  };\n\n  LocalTrackPublicationV2.prototype.updateMediaStates = function (mediaStates) {\n    if (!mediaStates || !mediaStates.recordings || this._mediaStates.recordings === mediaStates.recordings) {\n      return this;\n    }\n\n    this._mediaStates.recordings = mediaStates.recordings;\n\n    switch (this._mediaStates.recordings) {\n      case 'OK':\n        this._log.info('Warnings have cleared.');\n\n        this.emit('warningsCleared');\n        break;\n\n      case 'NO_MEDIA':\n        this._log.warn('Recording media lost.');\n\n        this.emit('warning', TwilioWarning.recordingMediaLost);\n        break;\n\n      default:\n        this._log.warn(\"Unknown media state detected: \" + this._mediaStates.recordings);\n\n        break;\n    }\n\n    return this;\n  };\n\n  return LocalTrackPublicationV2;\n}(LocalTrackPublicationSignaling);\n/**\n * The Room Signaling Protocol (RSP) representation of a {@link LocalTrackPublicationV2}.\n * @typedef {object} LocalTrackPublicationV2#Representation\n * @property {boolean} enabled\n * @property {Track.ID} id\n * @property {Track.Kind} kind\n * @property {string} name\n * @priority {Track.Priority} priority\n * @property {Track.SID} sid\n */\n\n\nmodule.exports = LocalTrackPublicationV2;","map":{"version":3,"mappings":"AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,8BAA8B,GAAGC,OAAO,CAAC,0BAAD,CAA9C;;AACA,IAAMC,aAAa,GAAGD,OAAO,CAAC,0BAAD,CAA7B;;AACA,IAAME,iBAAiB,GAAGF,OAAO,CAAC,gCAAD,CAAP,CAA0CE,iBAApE;AAEA;;;;;AAGA;AAAA;AAAA;EAAsCC;EACpC;;;;;;;;;EAOA,iCAAYC,WAAZ,EAAyBC,IAAzB,EAA+BC,QAA/B,EAAyCC,OAAzC,EAAgD;IAAhD,YACEC,kBAAMJ,WAAN,EAAmBC,IAAnB,EAAyBC,QAAzB,KAAkC,IADpC;;IAEEG,MAAM,CAACC,gBAAP,CAAwBC,KAAxB,EAA8B;MAC5BC,IAAI,EAAE;QACJC,KAAK,EAAEN,OAAO,CAACO,GAAR,CAAYC,SAAZ,CAAsB,SAAtB,EAAiCJ,KAAjC;MADH,CADsB;MAI5BK,YAAY,EAAE;QACZH,KAAK,EAAE;UAAEI,UAAU,EAAE;QAAd,CADK;QAEZC,QAAQ,EAAE;MAFE;IAJc,CAA9B;;EASD;EAED;;;;;;EAIAC;IACE,OAAO;MACLC,OAAO,EAAE,KAAKC,SADT;MAELC,EAAE,EAAE,KAAKA,EAFJ;MAGLC,IAAI,EAAE,KAAKA,IAHN;MAILlB,IAAI,EAAE,KAAKA,IAJN;MAKLC,QAAQ,EAAE,KAAKkB;IALV,CAAP;EAOD,CARD;;EAUAL;IACE,OAAO,+BAA6B,KAAKM,GAAlC,GAAqC,GAA5C;EACD,CAFD;EAIA;;;;;;;;;EAOAN,qDAAOO,KAAP,EAAY;IACV,QAAQA,KAAK,CAACC,KAAd;MACE,KAAK,OAAL;QACE,KAAKC,MAAL,CAAYF,KAAK,CAACD,GAAlB;QACA;;MACF,KAAK,QAAL;QAAe;UACb,IAAMI,KAAK,GAAGH,KAAK,CAACG,KAApB;UACA,KAAKC,aAAL,CAAmB5B,iBAAiB,CAAC2B,KAAK,CAACE,IAAP,EAAaF,KAAK,CAACG,OAAnB,CAApC;UACA;QACD;;MACD;QAAS;QACP;IAVJ;;IAYA,OAAO,IAAP;EACD,CAdD;;EAgBAb,gEAAkBc,WAAlB,EAA6B;IAC3B,IAAI,CAACA,WAAD,IAAgB,CAACA,WAAW,CAAChB,UAA7B,IACF,KAAKD,YAAL,CAAkBC,UAAlB,KAAiCgB,WAAW,CAAChB,UAD/C,EAC2D;MACzD,OAAO,IAAP;IACD;;IACD,KAAKD,YAAL,CAAkBC,UAAlB,GAA+BgB,WAAW,CAAChB,UAA3C;;IACA,QAAQ,KAAKD,YAAL,CAAkBC,UAA1B;MACE,KAAK,IAAL;QACE,KAAKL,IAAL,CAAUsB,IAAV,CAAe,wBAAf;;QACA,KAAKC,IAAL,CAAU,iBAAV;QACA;;MACF,KAAK,UAAL;QACE,KAAKvB,IAAL,CAAUwB,IAAV,CAAe,uBAAf;;QACA,KAAKD,IAAL,CAAU,SAAV,EAAqBlC,aAAa,CAACoC,kBAAnC;QACA;;MACF;QACE,KAAKzB,IAAL,CAAUwB,IAAV,CAAe,mCAAiC,KAAKpB,YAAL,CAAkBC,UAAlE;;QACA;IAXJ;;IAaA,OAAO,IAAP;EACD,CApBD;;EAqBF;AAAC,CAnFD,CAAsClB,8BAAtC;AAqFA;;;;;;;;;;;;AAWAuC,MAAM,CAACC,OAAP,GAAiBpB,uBAAjB","names":["LocalTrackPublicationSignaling","require","TwilioWarning","createTwilioError","__extends","trackSender","name","priority","options","_super","Object","defineProperties","_this","_log","value","log","createLog","_mediaStates","recordings","writable","LocalTrackPublicationV2","enabled","isEnabled","id","kind","updatedPriority","sid","track","state","setSid","error","publishFailed","code","message","mediaStates","info","emit","warn","recordingMediaLost","module","exports"],"sources":["/home/samliu/repos/ieee/twilio-video-starter-kit/node_modules/twilio-video/lib/signaling/v2/localtrackpublication.js"],"sourcesContent":["'use strict';\n\nconst LocalTrackPublicationSignaling = require('../localtrackpublication');\nconst TwilioWarning = require('../../util/twiliowarning');\nconst createTwilioError = require('../../util/twilio-video-errors').createTwilioError;\n\n/**\n * @extends LocalTrackPublicationSignaling\n */\nclass LocalTrackPublicationV2 extends LocalTrackPublicationSignaling {\n  /**\n   * Construct a {@link LocalTrackPublicationV2}.\n   * @param {DataTrackSender|MediaTrackSender} trackSender\n   * @param {string} name\n   * @param {Track.Priority} priority\n   * @param {object} [options]\n   */\n  constructor(trackSender, name, priority, options) {\n    super(trackSender, name, priority);\n    Object.defineProperties(this, {\n      _log: {\n        value: options.log.createLog('default', this)\n      },\n      _mediaStates: {\n        value: { recordings: null },\n        writable: true\n      }\n    });\n  }\n\n  /**\n   * Get the {@link LocalTrackPublicationV2#Representation} of a given {@link TrackSignaling}.\n   * @returns {LocalTrackPublicationV2#Representation} - without the SID\n   */\n  getState() {\n    return {\n      enabled: this.isEnabled,\n      id: this.id,\n      kind: this.kind,\n      name: this.name,\n      priority: this.updatedPriority\n    };\n  }\n\n  toString() {\n    return `[LocalTrackPublicationV2: ${this.sid}]`;\n  }\n\n  /**\n   * Compare the {@link LocalTrackPublicationV2} to a {@link LocalTrackPublicationV2#Representation} of itself\n   * and perform any updates necessary.\n   * @param {PublishedTrack} track\n   * @returns {this}\n   * @fires TrackSignaling#updated\n   */\n  update(track) {\n    switch (track.state) {\n      case 'ready':\n        this.setSid(track.sid);\n        break;\n      case 'failed': {\n        const error = track.error;\n        this.publishFailed(createTwilioError(error.code, error.message));\n        break;\n      }\n      default: // 'created'\n        break;\n    }\n    return this;\n  }\n\n  updateMediaStates(mediaStates) {\n    if (!mediaStates || !mediaStates.recordings ||\n      this._mediaStates.recordings === mediaStates.recordings) {\n      return this;\n    }\n    this._mediaStates.recordings = mediaStates.recordings;\n    switch (this._mediaStates.recordings) {\n      case 'OK':\n        this._log.info('Warnings have cleared.');\n        this.emit('warningsCleared');\n        break;\n      case 'NO_MEDIA':\n        this._log.warn('Recording media lost.');\n        this.emit('warning', TwilioWarning.recordingMediaLost);\n        break;\n      default:\n        this._log.warn(`Unknown media state detected: ${this._mediaStates.recordings}`);\n        break;\n    }\n    return this;\n  }\n}\n\n/**\n * The Room Signaling Protocol (RSP) representation of a {@link LocalTrackPublicationV2}.\n * @typedef {object} LocalTrackPublicationV2#Representation\n * @property {boolean} enabled\n * @property {Track.ID} id\n * @property {Track.Kind} kind\n * @property {string} name\n * @priority {Track.Priority} priority\n * @property {Track.SID} sid\n */\n\nmodule.exports = LocalTrackPublicationV2;\n"]},"metadata":{},"sourceType":"script"}