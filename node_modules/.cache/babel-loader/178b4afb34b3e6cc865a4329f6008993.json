{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.syntheticAudio = void 0;\n\nfunction syntheticAudio() {\n  // NOTE(mpatwardhan): We have to delay require-ing AudioContextFactory, because\n  // it exports a default instance whose constructor calls Object.assign.\n  var audioContextFactory = require('../webaudio/audiocontext');\n\n  var holder = {};\n  var audioContext = audioContextFactory.getOrCreate(holder);\n  var oscillator = audioContext.createOscillator();\n  var dst = oscillator.connect(audioContext.createMediaStreamDestination());\n  oscillator.start();\n  var track = dst.stream.getAudioTracks()[0];\n  var originalStop = track.stop;\n\n  track.stop = function () {\n    originalStop.call(track);\n    audioContextFactory.release(holder);\n  };\n\n  return track;\n}\n\nexports.syntheticAudio = syntheticAudio;","map":{"version":3,"mappings":";;;;;;;AAIA,SAAgBA,cAAhB,GAA8B;EAC5B;EACA;EACA,IAAMC,mBAAmB,GAAGC,OAAO,CAAC,0BAAD,CAAnC;;EACA,IAAMC,MAAM,GAAG,EAAf;EACA,IAAMC,YAAY,GAAGH,mBAAmB,CAACI,WAApB,CAAgCF,MAAhC,CAArB;EACA,IAAMG,UAAU,GAAGF,YAAY,CAACG,gBAAb,EAAnB;EACA,IAAMC,GAAG,GAAGF,UAAU,CAACG,OAAX,CAAmBL,YAAY,CAACM,4BAAb,EAAnB,CAAZ;EACAJ,UAAU,CAACK,KAAX;EACA,IAAMC,KAAK,GAAGJ,GAAG,CAACK,MAAJ,CAAWC,cAAX,GAA4B,CAA5B,CAAd;EACA,IAAMC,YAAY,GAAGH,KAAK,CAACI,IAA3B;;EACAJ,KAAK,CAACI,IAAN,GAAa;IACXD,YAAY,CAACE,IAAb,CAAkBL,KAAlB;IACAX,mBAAmB,CAACiB,OAApB,CAA4Bf,MAA5B;EACD,CAHD;;EAIA,OAAOS,KAAP;AACD;;AAhBDO","names":["syntheticAudio","audioContextFactory","require","holder","audioContext","getOrCreate","oscillator","createOscillator","dst","connect","createMediaStreamDestination","start","track","stream","getAudioTracks","originalStop","stop","call","release","exports"],"sources":["/home/samliu/repos/ieee/tp-robot/node_modules/twilio-video/lib/preflight/syntheticaudio.ts"],"sourcesContent":["interface MediaStreamAudioDestinationNode extends AudioNode {\n  stream: MediaStream;\n}\n\nexport function syntheticAudio(): MediaStreamTrack {\n  // NOTE(mpatwardhan): We have to delay require-ing AudioContextFactory, because\n  // it exports a default instance whose constructor calls Object.assign.\n  const audioContextFactory = require('../webaudio/audiocontext');\n  const holder = {};\n  const audioContext = audioContextFactory.getOrCreate(holder);\n  const oscillator = audioContext.createOscillator();\n  const dst = oscillator.connect(audioContext.createMediaStreamDestination()) as MediaStreamAudioDestinationNode;\n  oscillator.start();\n  const track = dst.stream.getAudioTracks()[0];\n  const originalStop = track.stop;\n  track.stop = () => {\n    originalStop.call(track);\n    audioContextFactory.release(holder);\n  };\n  return track;\n}\n"]},"metadata":{},"sourceType":"script"}