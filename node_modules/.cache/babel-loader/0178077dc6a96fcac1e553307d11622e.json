{"ast":null,"code":"'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar StateMachine = require('../statemachine');\n\nvar NetworkQualityStats = require('../stats/networkqualitystats');\n/*\nParticipantSignaling States\n----------------------\n\n    +------------+     +-----------+     +--------------+\n    |            |     |           |     |              |\n    | connecting |---->| connected |---->| disconnected |\n    |            |     |           |     |              |\n    +------------+     +-----------+     +--------------+\n                           | ^                    ^\n                           | |  +--------------+  |\n                           | |--|              |  |\n                           |--->| reconnecting |--|\n                                |              |\n                                +--------------+\n*/\n\n\nvar states = {\n  connecting: ['connected'],\n  connected: ['disconnected', 'reconnecting'],\n  reconnecting: ['connected', 'disconnected'],\n  disconnected: []\n};\n/**\n * A {@link Participant} implementation\n * @extends StateMachine\n * @property {?string} identity\n * @property {?Participant.SID} sid\n * @property {string} state - \"connecting\", \"connected\", or \"disconnected\"\n * @property {Map<Track.ID | Track.SID, TrackSignaling>} tracks\n * @emits ParticipantSignaling#networkQualityLevelChanged\n * @emits ParticipantSignaling#trackAdded\n * @emits ParticipantSignaling#trackRemoved\n */\n\nvar ParticipantSignaling =\n/** @class */\nfunction (_super) {\n  __extends(ParticipantSignaling, _super);\n  /**\n   * Construct a {@link ParticipantSignaling}.\n   */\n\n\n  function ParticipantSignaling() {\n    var _this = _super.call(this, 'connecting', states) || this;\n\n    Object.defineProperties(_this, {\n      _identity: {\n        writable: true,\n        value: null\n      },\n      _networkQualityLevel: {\n        value: null,\n        writable: true\n      },\n      _networkQualityStats: {\n        value: null,\n        writable: true\n      },\n      _sid: {\n        writable: true,\n        value: null\n      },\n      identity: {\n        enumerable: true,\n        get: function () {\n          return this._identity;\n        }\n      },\n      sid: {\n        enumerable: true,\n        get: function () {\n          return this._sid;\n        }\n      },\n      tracks: {\n        enumerable: true,\n        value: new Map()\n      }\n    });\n    return _this;\n  }\n\n  Object.defineProperty(ParticipantSignaling.prototype, \"networkQualityLevel\", {\n    /**\n     * Get the current {@link NetworkQualityLevel}, if any.\n     * @returns {?NetworkQualityLevel} networkQualityLevel - initially null\n     */\n    get: function () {\n      return this._networkQualityLevel;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  Object.defineProperty(ParticipantSignaling.prototype, \"networkQualityStats\", {\n    /**\n     * Get the current {@link NetworkQualityStats}\n     * @returns {?NetworkQualityStats} networkQualityStats - initially null\n     */\n    get: function () {\n      return this._networkQualityStats;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * Add the {@link TrackSignaling}, MediaStreamTrack, or\n   * {@link DataTrackSender} to the {@link ParticipantSignaling}.\n   * @param {TrackSignaling|DataTrackSender|MediaTrackSender} track\n   * @returns {this}\n   * @fires ParticipantSignaling#trackAdded\n   */\n\n  ParticipantSignaling.prototype.addTrack = function (track) {\n    this.tracks.set(track.id || track.sid, track);\n    this.emit('trackAdded', track);\n    return this;\n  };\n  /**\n   * Disconnect the {@link ParticipantSignaling}.\n   * @returns {boolean}\n   */\n\n\n  ParticipantSignaling.prototype.disconnect = function () {\n    if (this.state !== 'disconnected') {\n      this.preempt('disconnected');\n      return true;\n    }\n\n    return false;\n  };\n  /**\n   * Remove the {@link TrackSignaling}, MediaStreamTrack, or\n   * {@link DataTrackSender} from the {@link ParticipantSignaling}.\n   * @param {TrackSignaling|DataTrackSender|MediaTrackSender} track\n   * @returns {?TrackSignaling}\n   * @fires ParticipantSignaling#trackRemoved\n   */\n\n\n  ParticipantSignaling.prototype.removeTrack = function (track) {\n    var signaling = this.tracks.get(track.id || track.sid);\n    this.tracks.delete(track.id || track.sid);\n\n    if (signaling) {\n      this.emit('trackRemoved', track);\n    }\n\n    return signaling || null;\n  };\n  /**\n   * @param {NetworkQualityLevel} networkQualityLevel\n   * @param {?NetworkQualityLevels} [networkQualityLevels=null]\n   * @returns {void}\n   */\n\n\n  ParticipantSignaling.prototype.setNetworkQualityLevel = function (networkQualityLevel, networkQualityLevels) {\n    if (this._networkQualityLevel !== networkQualityLevel) {\n      this._networkQualityLevel = networkQualityLevel;\n      this._networkQualityStats = networkQualityLevels && (networkQualityLevels.audio || networkQualityLevels.video) ? new NetworkQualityStats(networkQualityLevels) : null;\n      this.emit('networkQualityLevelChanged');\n    }\n  };\n  /**\n   * Connect the {@link ParticipantSignaling}.\n   * @param {Participant.SID} sid\n   * @param {string} identity\n   * @returns {boolean}\n   */\n\n\n  ParticipantSignaling.prototype.connect = function (sid, identity) {\n    if (this.state === 'connecting' || this.state === 'reconnecting') {\n      if (!this._sid) {\n        this._sid = sid;\n      }\n\n      if (!this._identity) {\n        this._identity = identity;\n      }\n\n      this.preempt('connected');\n      return true;\n    }\n\n    return false;\n  };\n  /**\n   * Transition to \"reconnecting\" state.\n   * @returns {boolean}\n   */\n\n\n  ParticipantSignaling.prototype.reconnecting = function () {\n    if (this.state === 'connecting' || this.state === 'connected') {\n      this.preempt('reconnecting');\n      return true;\n    }\n\n    return false;\n  };\n\n  return ParticipantSignaling;\n}(StateMachine);\n/**\n * @event ParticipantSignaling#event:networkQualityLevelChanged\n */\n\n/**\n * {@link TrackSignaling} was added to the {@link ParticipantSignaling}.\n * @event ParticipantSignaling#trackAdded\n * @param {TrackSignaling} track\n */\n\n/**\n * {@link TrackSignaling} was removed from the {@link ParticipantSignaling}.\n * @event ParticipantSignaling#trackRemoved\n * @param {TrackSignaling} track\n */\n\n\nmodule.exports = ParticipantSignaling;","map":{"version":3,"mappings":"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","names":["StateMachine","require","NetworkQualityStats","states","connecting","connected","reconnecting","disconnected","__extends","_super","Object","defineProperties","_this","_identity","writable","value","_networkQualityLevel","_networkQualityStats","_sid","identity","enumerable","get","sid","tracks","Map","ParticipantSignaling","track","set","id","emit","state","preempt","signaling","delete","networkQualityLevel","networkQualityLevels","audio","video","module","exports"],"sources":["/home/samliu/repos/ieee/tp-robot/node_modules/twilio-video/lib/signaling/participant.js"],"sourcesContent":["'use strict';\n\nconst StateMachine = require('../statemachine');\nconst NetworkQualityStats = require('../stats/networkqualitystats');\n\n/*\nParticipantSignaling States\n----------------------\n\n    +------------+     +-----------+     +--------------+\n    |            |     |           |     |              |\n    | connecting |---->| connected |---->| disconnected |\n    |            |     |           |     |              |\n    +------------+     +-----------+     +--------------+\n                           | ^                    ^\n                           | |  +--------------+  |\n                           | |--|              |  |\n                           |--->| reconnecting |--|\n                                |              |\n                                +--------------+\n*/\n\nconst states = {\n  connecting: [\n    'connected'\n  ],\n  connected: [\n    'disconnected',\n    'reconnecting'\n  ],\n  reconnecting: [\n    'connected',\n    'disconnected'\n  ],\n  disconnected: []\n};\n\n/**\n * A {@link Participant} implementation\n * @extends StateMachine\n * @property {?string} identity\n * @property {?Participant.SID} sid\n * @property {string} state - \"connecting\", \"connected\", or \"disconnected\"\n * @property {Map<Track.ID | Track.SID, TrackSignaling>} tracks\n * @emits ParticipantSignaling#networkQualityLevelChanged\n * @emits ParticipantSignaling#trackAdded\n * @emits ParticipantSignaling#trackRemoved\n */\nclass ParticipantSignaling extends StateMachine {\n  /**\n   * Construct a {@link ParticipantSignaling}.\n   */\n  constructor() {\n    super('connecting', states);\n\n    Object.defineProperties(this, {\n      _identity: {\n        writable: true,\n        value: null\n      },\n      _networkQualityLevel: {\n        value: null,\n        writable: true\n      },\n      _networkQualityStats: {\n        value: null,\n        writable: true\n      },\n      _sid: {\n        writable: true,\n        value: null\n      },\n      identity: {\n        enumerable: true,\n        get() {\n          return this._identity;\n        }\n      },\n      sid: {\n        enumerable: true,\n        get() {\n          return this._sid;\n        }\n      },\n      tracks: {\n        enumerable: true,\n        value: new Map()\n      }\n    });\n  }\n\n  /**\n   * Get the current {@link NetworkQualityLevel}, if any.\n   * @returns {?NetworkQualityLevel} networkQualityLevel - initially null\n   */\n  get networkQualityLevel() {\n    return this._networkQualityLevel;\n  }\n\n  /**\n   * Get the current {@link NetworkQualityStats}\n   * @returns {?NetworkQualityStats} networkQualityStats - initially null\n   */\n  get networkQualityStats() {\n    return this._networkQualityStats;\n  }\n\n  /**\n   * Add the {@link TrackSignaling}, MediaStreamTrack, or\n   * {@link DataTrackSender} to the {@link ParticipantSignaling}.\n   * @param {TrackSignaling|DataTrackSender|MediaTrackSender} track\n   * @returns {this}\n   * @fires ParticipantSignaling#trackAdded\n   */\n  addTrack(track) {\n    this.tracks.set(track.id || track.sid, track);\n    this.emit('trackAdded', track);\n    return this;\n  }\n\n  /**\n   * Disconnect the {@link ParticipantSignaling}.\n   * @returns {boolean}\n   */\n  disconnect() {\n    if (this.state !== 'disconnected') {\n      this.preempt('disconnected');\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Remove the {@link TrackSignaling}, MediaStreamTrack, or\n   * {@link DataTrackSender} from the {@link ParticipantSignaling}.\n   * @param {TrackSignaling|DataTrackSender|MediaTrackSender} track\n   * @returns {?TrackSignaling}\n   * @fires ParticipantSignaling#trackRemoved\n   */\n  removeTrack(track) {\n    const signaling = this.tracks.get(track.id || track.sid);\n    this.tracks.delete(track.id || track.sid);\n    if (signaling) {\n      this.emit('trackRemoved', track);\n    }\n    return signaling || null;\n  }\n\n  /**\n   * @param {NetworkQualityLevel} networkQualityLevel\n   * @param {?NetworkQualityLevels} [networkQualityLevels=null]\n   * @returns {void}\n   */\n  setNetworkQualityLevel(networkQualityLevel, networkQualityLevels) {\n    if (this._networkQualityLevel !== networkQualityLevel) {\n      this._networkQualityLevel = networkQualityLevel;\n      this._networkQualityStats = networkQualityLevels\n      && (networkQualityLevels.audio || networkQualityLevels.video)\n        ? new NetworkQualityStats(networkQualityLevels)\n        : null;\n      this.emit('networkQualityLevelChanged');\n    }\n  }\n\n  /**\n   * Connect the {@link ParticipantSignaling}.\n   * @param {Participant.SID} sid\n   * @param {string} identity\n   * @returns {boolean}\n   */\n  connect(sid, identity) {\n    if (this.state === 'connecting' || this.state === 'reconnecting') {\n      if (!this._sid) {\n        this._sid = sid;\n      }\n      if (!this._identity) {\n        this._identity = identity;\n      }\n      this.preempt('connected');\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Transition to \"reconnecting\" state.\n   * @returns {boolean}\n   */\n  reconnecting() {\n    if (this.state === 'connecting' || this.state === 'connected') {\n      this.preempt('reconnecting');\n      return true;\n    }\n    return false;\n  }\n}\n\n/**\n * @event ParticipantSignaling#event:networkQualityLevelChanged\n */\n\n/**\n * {@link TrackSignaling} was added to the {@link ParticipantSignaling}.\n * @event ParticipantSignaling#trackAdded\n * @param {TrackSignaling} track\n */\n\n/**\n * {@link TrackSignaling} was removed from the {@link ParticipantSignaling}.\n * @event ParticipantSignaling#trackRemoved\n * @param {TrackSignaling} track\n */\n\nmodule.exports = ParticipantSignaling;\n"]},"metadata":{},"sourceType":"script"}