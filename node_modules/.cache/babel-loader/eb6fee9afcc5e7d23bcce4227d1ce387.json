{"ast":null,"code":"/* eslint callback-return:0 */\n'use strict';\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar MediaSignaling = require('./mediasignaling');\n\nvar messageId = 1;\n\nvar PublisherHintsSignaling =\n/** @class */\nfunction (_super) {\n  __extends(PublisherHintsSignaling, _super);\n  /**\n   * Construct a {@link RenderHintsSignaling}.\n   */\n\n\n  function PublisherHintsSignaling(getReceiver, options) {\n    var _this = _super.call(this, getReceiver, 'publisher_hints', options) || this;\n\n    _this.on('ready', function (transport) {\n      _this._log.debug('publisher_hints transport ready:', transport);\n\n      transport.on('message', function (message) {\n        _this._log.debug('Incoming: ', message);\n\n        switch (message.type) {\n          case 'publisher_hints':\n            if (message.publisher && message.publisher.hints && message.publisher.id) {\n              _this._processPublisherHints(message.publisher.hints, message.publisher.id);\n            }\n\n            break;\n\n          default:\n            _this._log.warn('Unknown message type: ', message.type);\n\n            break;\n        }\n      });\n    });\n\n    return _this;\n  }\n\n  PublisherHintsSignaling.prototype.sendTrackReplaced = function (_a) {\n    var trackSid = _a.trackSid;\n\n    if (!this._transport) {\n      return;\n    }\n\n    var payLoad = {\n      type: 'client_reset',\n      track: trackSid,\n      id: messageId++\n    };\n\n    this._log.debug('Outgoing: ', payLoad);\n\n    this._transport.publish(payLoad);\n  };\n\n  PublisherHintsSignaling.prototype.sendHintResponse = function (_a) {\n    var id = _a.id,\n        hints = _a.hints;\n\n    if (!this._transport) {\n      return;\n    }\n\n    var payLoad = {\n      type: 'publisher_hints',\n      id: id,\n      hints: hints\n    };\n\n    this._log.debug('Outgoing: ', payLoad);\n\n    this._transport.publish(payLoad);\n  };\n  /**\n   * @private\n   */\n\n\n  PublisherHintsSignaling.prototype._processPublisherHints = function (hints, id) {\n    try {\n      this.emit('updated', hints, id);\n    } catch (ex) {\n      this._log.error('error processing hints:', ex);\n    }\n  };\n\n  return PublisherHintsSignaling;\n}(MediaSignaling);\n\nmodule.exports = PublisherHintsSignaling;","map":{"version":3,"mappings":"AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAMA,cAAc,GAAGC,OAAO,CAAC,kBAAD,CAA9B;;AAEA,IAAIC,SAAS,GAAG,CAAhB;;AACA;AAAA;AAAA;EAAsCC;EACpC;;;;;EAGA,iCAAYC,WAAZ,EAAyBC,OAAzB,EAAgC;IAAhC,YACEC,kBAAMF,WAAN,EAAmB,iBAAnB,EAAsCC,OAAtC,KAA8C,IADhD;;IAEEE,KAAI,CAACC,EAAL,CAAQ,OAAR,EAAiB,qBAAS;MACxBD,KAAI,CAACE,IAAL,CAAUC,KAAV,CAAgB,kCAAhB,EAAoDC,SAApD;;MACAA,SAAS,CAACH,EAAV,CAAa,SAAb,EAAwB,mBAAO;QAC7BD,KAAI,CAACE,IAAL,CAAUC,KAAV,CAAgB,YAAhB,EAA8BE,OAA9B;;QACA,QAAQA,OAAO,CAACC,IAAhB;UACE,KAAK,iBAAL;YACE,IAAID,OAAO,CAACE,SAAR,IAAqBF,OAAO,CAACE,SAAR,CAAkBC,KAAvC,IAAgDH,OAAO,CAACE,SAAR,CAAkBE,EAAtE,EAA0E;cACxET,KAAI,CAACU,sBAAL,CAA4BL,OAAO,CAACE,SAAR,CAAkBC,KAA9C,EAAqDH,OAAO,CAACE,SAAR,CAAkBE,EAAvE;YACD;;YACD;;UACF;YACET,KAAI,CAACE,IAAL,CAAUS,IAAV,CAAe,wBAAf,EAAyCN,OAAO,CAACC,IAAjD;;YACA;QARJ;MAUD,CAZD;IAaD,CAfD;;;EAgBD;;EAEDM,gEAAkBC,EAAlB,EAA8B;QAAVC,QAAQ;;IAC1B,IAAI,CAAC,KAAKC,UAAV,EAAsB;MACpB;IACD;;IAED,IAAMC,OAAO,GAAG;MACdV,IAAI,EAAE,cADQ;MAEdW,KAAK,EAAEH,QAFO;MAGdL,EAAE,EAAEd,SAAS;IAHC,CAAhB;;IAKA,KAAKO,IAAL,CAAUC,KAAV,CAAgB,YAAhB,EAA8Ba,OAA9B;;IACA,KAAKD,UAAL,CAAgBG,OAAhB,CAAwBF,OAAxB;EACD,CAZD;;EAcAJ,+DAAiBC,EAAjB,EAA8B;QAAXJ,EAAE;QAAED,KAAK;;IAC1B,IAAI,CAAC,KAAKO,UAAV,EAAsB;MACpB;IACD;;IACD,IAAMC,OAAO,GAAG;MACdV,IAAI,EAAE,iBADQ;MAEdG,EAAE,IAFY;MAGdD,KAAK;IAHS,CAAhB;;IAKA,KAAKN,IAAL,CAAUC,KAAV,CAAgB,YAAhB,EAA8Ba,OAA9B;;IACA,KAAKD,UAAL,CAAgBG,OAAhB,CAAwBF,OAAxB;EACD,CAXD;EAaA;;;;;EAGAJ,qEAAuBJ,KAAvB,EAA8BC,EAA9B,EAAgC;IAC9B,IAAI;MACF,KAAKU,IAAL,CAAU,SAAV,EAAqBX,KAArB,EAA4BC,EAA5B;IACD,CAFD,CAEE,OAAOW,EAAP,EAAW;MACX,KAAKlB,IAAL,CAAUmB,KAAV,CAAgB,yBAAhB,EAA2CD,EAA3C;IACD;EACF,CAND;;EAOF;AAAC,CA7DD,CAAsC3B,cAAtC;;AAgEA6B,MAAM,CAACC,OAAP,GAAiBX,uBAAjB","names":["MediaSignaling","require","messageId","__extends","getReceiver","options","_super","_this","on","_log","debug","transport","message","type","publisher","hints","id","_processPublisherHints","warn","PublisherHintsSignaling","_a","trackSid","_transport","payLoad","track","publish","emit","ex","error","module","exports"],"sources":["/home/samliu/repos/ieee/twilio-video-starter-kit/node_modules/twilio-video/lib/signaling/v2/publisherhintsignaling.js"],"sourcesContent":["/* eslint callback-return:0 */\n'use strict';\n\nconst MediaSignaling = require('./mediasignaling');\n\nlet messageId = 1;\nclass PublisherHintsSignaling extends MediaSignaling {\n  /**\n   * Construct a {@link RenderHintsSignaling}.\n   */\n  constructor(getReceiver, options) {\n    super(getReceiver, 'publisher_hints', options);\n    this.on('ready', transport => {\n      this._log.debug('publisher_hints transport ready:', transport);\n      transport.on('message', message => {\n        this._log.debug('Incoming: ', message);\n        switch (message.type) {\n          case 'publisher_hints':\n            if (message.publisher && message.publisher.hints && message.publisher.id) {\n              this._processPublisherHints(message.publisher.hints, message.publisher.id);\n            }\n            break;\n          default:\n            this._log.warn('Unknown message type: ', message.type);\n            break;\n        }\n      });\n    });\n  }\n\n  sendTrackReplaced({ trackSid }) {\n    if (!this._transport) {\n      return;\n    }\n\n    const payLoad = {\n      type: 'client_reset',\n      track: trackSid,\n      id: messageId++\n    };\n    this._log.debug('Outgoing: ', payLoad);\n    this._transport.publish(payLoad);\n  }\n\n  sendHintResponse({ id, hints }) {\n    if (!this._transport) {\n      return;\n    }\n    const payLoad = {\n      type: 'publisher_hints',\n      id,\n      hints\n    };\n    this._log.debug('Outgoing: ', payLoad);\n    this._transport.publish(payLoad);\n  }\n\n  /**\n   * @private\n   */\n  _processPublisherHints(hints, id) {\n    try {\n      this.emit('updated', hints, id);\n    } catch (ex) {\n      this._log.error('error processing hints:', ex);\n    }\n  }\n}\n\n\nmodule.exports = PublisherHintsSignaling;\n"]},"metadata":{},"sourceType":"script"}